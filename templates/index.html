<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Calculadora de ARL</title>
    <script>
        function toggleFields() {
            var useAlpha = document.getElementById('alpha_option').checked;
            var alphaField = document.getElementById('alpha_field');
            var LCyntField = document.getElementById('LCynt_field');

            if (useAlpha) {
                alphaField.style.display = 'block';
                LCyntField.style.display = 'none';
            } else {
                alphaField.style.display = 'none';
                LCyntField.style.display = 'block';
            }
        }
    </script>
</head>

<body onload="toggleFields();">
    <h1>Calculadora de ARL y ARL Intercalado</h1>
    {% if error %}
    <p style="color:red;">{{ error }}</p>
    {% endif %}
    <form method="post">
        <label for="m">Número de Muestras (m):</label><br>
        <input type="number" id="m" name="m" required value="{{ m if m is not none else '' }}"><br><br>

        <label for="n">Tamaño de Muestra (n):</label><br>
        <input type="number" id="n" name="n" required value="{{ n if n is not none else '' }}"><br><br>

        <label for="p">Número de Variables (p):</label><br>
        <input type="number" id="p" name="p" required value="{{ p if p is not none else '' }}"><br><br>

        <label for="Delta">Desplazamiento Delta:</label><br>
        <input type="number" step="any" id="Delta" name="Delta" required
            value="{{ Delta if Delta is not none else '' }}"><br><br>

        <label for="L">Parámetro L:</label><br>
        <input type="number" id="L" name="L" required value="{{ L if L is not none else '' }}"><br><br>

        <label>Seleccione una opción:</label><br>
        <input type="radio" id="alpha_option" name="use_alpha" value="alpha" onclick="toggleFields();" {% if
            use_alpha=='alpha' %}checked{% endif %}>
        <label for="alpha_option">Usar Alpha</label><br>
        <input type="radio" id="LCynt_option" name="use_alpha" value="LCynt" onclick="toggleFields();" {% if
            use_alpha=='LCynt' %}checked{% endif %}>
        <label for="LCynt_option">Usar LCynt</label><br><br>

        <div id="alpha_field" style="display: none;">
            <label for="alpha">Nivel de Significancia Alpha:</label><br>
            <input type="number" step="any" id="alpha" name="alpha"
                value="{{ alpha if alpha is not none else '' }}"><br><br>
        </div>

        <div id="LCynt_field" style="display: none;">
            <label for="LCynt">Límite de Control Superior (LCynt):</label><br>
            <input type="number" step="any" id="LCynt" name="LCynt"
                value="{{ LCynt if LCynt is not none else '' }}"><br><br>
        </div>

        <input type="submit" value="Calcular">
    </form>

    {% if results %}
    <h2>Resultados:</h2>
    <p><strong>ARL:</strong> {{ results['ARL'] }}</p>
    <p><strong>ARL Intercalado:</strong> {{ results['ARL_Intercalado'] }}</p>

    <h2>Gráfica de T² con Límite LCynt:</h2>
    {{ grafica_t2|safe }}

    {% endif %}

    <!-- Incluir la biblioteca de Plotly -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>


    <script>
        // Llamar a toggleFields() nuevamente para asegurar que los campos se muestren correctamente después de cargar los valores
        toggleFields();
    </script>
</body>

</html>